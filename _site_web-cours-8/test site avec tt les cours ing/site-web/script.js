const coursesData = [
    {
        name: "Anglais",
        icon: "üá¨üáß",
        documents: [
            { name: "Company organisation & structure.pdf", path: "../S1/S1/Anglais/Company organisation & structure.pdf" },
            { name: "Correction eval anglais.docx", path: "../S1/S1/Anglais/Correction eval anglais.docx" },
            { name: "Homework - 24_11_2023.pages", path: "../S1/S1/Anglais/Homework - 24_11_2023.pages" },
            { name: "Management.docx", path: "../S1/S1/Anglais/Management.docx" },
            { name: "Pr√©sentation1.ppt ING1 school year curriculum.ppt", path: "../S1/S1/Anglais/Pr√©sentation1.ppt ING1 school year curriculum.ppt" },
            { name: "toeic.txt", path: "../S1/S1/Anglais/toeic.txt" }
        ]
    },
    {
        name: "Base de Donn√©es (BDD)",
        icon: "üóÑÔ∏è",
        folders: [
            {
                name: "TD1 - MCD",
                path: "../S1/S1/BDD/TD1 - MCD"
            },
            {
                name: "TD2 - Du MCD au MLD Dependance Fonctionnelle",
                path: "../S1/S1/BDD/TD2-Du-MCD-au-MLD-Dependance-Fonctionnelle"
            },
            {
                name: "TD3 - Normalisation LDD",
                path: "../S1/S1/BDD/TD3-Normalisation-LDD"
            },
            {
                name: "TD4 - Langage de Manipulation de Donnees LMD",
                path: "../S1/S1/BDD/TD4-Langage-de-Manipulation-de-Donnees-LMD"
            },
            {
                name: "TD5-6 - Associations Collections",
                path: "../S1/S1/BDD/TD5-6-Associations-Collections"
            },
            {
                name: "TD5 - Requetes SELECT",
                path: "../S1/S1/BDD/TD5-Requetes-SELECT"
            },
            {
                name: "TD6 - Requetes SELECT",
                path: "../S1/S1/BDD/TD6-Requetes-SELECT"
            },
            {
                name: "TD7 - Requetes SELECT",
                path: "../S1/S1/BDD/TD7-Requetes-SELECT"
            }
        ],
        documents: [
            { name: "Cours 1 - Entit√© Association MCD.pdf", path: "../S1/S1/BDD/Cours 1 - Entit√© Association MCD.pdf" },
            { name: "Examen-BDD-2022-23-Rattrapage.pdf", path: "../S1/S1/BDD/Examen-BDD-2022-23-Rattrapage.pdf" },
            { name: "Examen-BDD-2022-23.pdf", path: "../S1/S1/BDD/Examen-BDD-2022-23.pdf" },
            { name: "Exercice MCD Golf Club.pdf", path: "../S1/S1/BDD/Exercice MCD Golf Club.pdf" },
            { name: "golf club.lo1", path: "../S1/S1/BDD/golf club.lo1" },
            { name: "golf club.loo", path: "../S1/S1/BDD/golf club.loo" },
            { name: "IMG_4258.HEIC", path: "../S1/S1/BDD/IMG_4258.HEIC" },
            { name: "IMG_4259.HEIC", path: "../S1/S1/BDD/IMG_4259.HEIC" },
            { name: "IMG_4262.HEIC", path: "../S1/S1/BDD/IMG_4262.HEIC" },
            { name: "IMG_4263.HEIC", path: "../S1/S1/BDD/IMG_4263.HEIC" },
            { name: "maj.bash", path: "../S1/S1/BDD/maj.bash" },
            { name: "MLD.jpg", path: "../S1/S1/BDD/MLD.jpg" },
            { name: "pokemon_diagram1.mwb", path: "../S1/S1/BDD/pokemon_diagram1.mwb" },
            { name: "pokemon_tables_ex2.sql", path: "../S1/S1/BDD/pokemon_tables_ex2.sql" },
            { name: "pokemon_tables.sql", path: "../S1/S1/BDD/pokemon_tables.sql" },
            { name: "Pokemons.png", path: "../S1/S1/BDD/Pokemons.png" },
            { name: "Pokemons2.png", path: "../S1/S1/BDD/Pokemons2.png" },
            { name: "Pokemons3.png", path: "../S1/S1/BDD/Pokemons3.png" }
        ]
    },
    {
        name: "Communication et Expression Fran√ßaise (CEF)",
        icon: "üé§",
        documents: [
            { name: "A voix haute.ts", path: "../S1/S1/CEF/A voix haute.ts" },
            { name: "dossier L'art de parler.pdf", path: "../S1/S1/CEF/dossier L'art de parler.pdf" },
            { name: "FICHEPARTIESDUDISCOURS.pdf", path: "../S1/S1/CEF/FICHEPARTIESDUDISCOURS.pdf" },
            { name: "Les parties du discours .pdf", path: "../S1/S1/CEF/Les parties du discours .pdf" },
            { name: "MAH00109.MP4", path: "../S1/S1/CEF/MAH00109.MP4" },
            { name: "S√©ance 1 CEF 3 apprentis copy.pptx", path: "../S1/S1/CEF/S√©ance 1 CEF 3 apprentis copy.pptx" },
            { name: "S√©ance 1 CEF 3 apprentis.pptx", path: "../S1/S1/CEF/S√©ance 1 CEF 3 apprentis.pptx" }
        ]
    },
    {
        name: "Data Exploration",
        icon: "üìä",
        folders: [
            {
                name: "Chapitre 1 - Analyse Univari√©e",
                path: "../S1/S1/Data exploration/Chapitre 1 - Analyse Univari√©e"
            },
            {
                name: "Chapitre 2 - Analyse Quanti x Quanti",
                path: "../S1/S1/Data exploration/Chapitre 2 - Analyse Quanti x Quanti"
            },
            {
                name: "Chapitre 3 - Analyse Quanti x Quali",
                path: "../S1/S1/Data exploration/Chapitre 3 - Analyse Quanti x Quali"
            },
            {
                name: "Chapitre 4 - Analyse Quali x Quali",
                path: "../S1/S1/Data exploration/Chapitre 4 - Analyse Quali x Quali"
            },
            {
                name: "Chapitre 5 - ACP",
                path: "../S1/S1/Data exploration/Chapitre 5 - ACP"
            },
            {
                name: "Jeu des donn√©es",
                path: "../S1/S1/Data exploration/Jeu des donn√©es"
            },
            {
                name: "Sujets",
                path: "../S1/S1/Data exploration/Sujets"
            }
        ],
        documents: [
            { name: "cours.docx", path: "../S1/S1/Data exploration/cours.docx" }
        ]
    },
    {
        name: "√âthique",
        icon: "‚öñÔ∏è",
        documents: [
            { name: "EST - CM1 - Introduction √† l'√©thique des sciences et des techniques.pdf", path: "../S1/S1/√âthique/EST - CM1 - Introduction √† l'√©thique des sciences et des techniques.pdf" },
            { name: "EST - CM2 - L'id√©e de progr√®s.pdf", path: "../S1/S1/√âthique/EST - CM2 - L'id√©e de progr√®s.pdf" },
            { name: "EST - CM3 - L'√©thique environnementale - 10-10-2023.pptx", path: "../S1/S1/√âthique/EST - CM3 - L'√©thique environnementale - 10-10-2023.pptx" },
            { name: "EST - CM4 - Enjeux √©thico-politiques du num√©rique - 03-11-2023.pptx", path: "../S1/S1/√âthique/EST - CM4 - Enjeux √©thico-politiques du num√©rique - 03-11-2023.pptx" },
            { name: "EST - CM4-5 - Enjeux √©thico-politiques du num√©rique - 10-11-2023.pptx", path: "../S1/S1/√âthique/EST - CM4-5 - Enjeux √©thico-politiques du num√©rique - 10-11-2023.pptx" },
            { name: "EST - S4 - Introduction √† la bio√©thique - 01-12-2023.pptx", path: "../S1/S1/√âthique/EST - S4 - Introduction √† la bio√©thique - 01-12-2023.pptx" },
            { name: "Plan du module Ethiques, sciences et techniques (EST) - 06-09-23.pdf", path: "../S1/S1/√âthique/Plan du module Ethiques, sciences et techniques (EST) - 06-09-23.pdf" }
        ]
    },
    {
        name: "Gestion de l'Entreprise",
        icon: "üíº",
        documents: [
            { name: "Examen-Comptabilit√©-G√©n√©rale-ING1-2021-2022.pdf", path: "../S1/S1/Gestion de l'entreprise/Examen-Comptabilit√©-G√©n√©rale-ING1-2021-2022.pdf" },
            { name: "fiche.pdf", path: "../S1/S1/Gestion de l'entreprise/fiche.pdf" },
            { name: "Le compte de r√©sultat.pdf", path: "../S1/S1/Gestion de l'entreprise/Le compte de r√©sultat.pdf" },
            { name: "TD1.pdf", path: "../S1/S1/Gestion de l'entreprise/TD1.pdf" },
            { name: "TD2.pdf", path: "../S1/S1/Gestion de l'entreprise/TD2.pdf" },
            { name: "TD3.pdf", path: "../S1/S1/Gestion de l'entreprise/TD3.pdf" },
            { name: "TD4-Cas-ALPHA.pdf", path: "../S1/S1/Gestion de l'entreprise/TD4-Cas-ALPHA.pdf" },
            { name: "TD5- Journal-Leron-Philppot.pdf", path: "../S1/S1/Gestion de l'entreprise/TD5- Journal-Leron-Philppot.pdf" },
            { name: "TD6 R√©ductions commerciales RRR ET R√©ductions financi√®res.pdf", path: "../S1/S1/Gestion de l'entreprise/TD6 R√©ductions commerciales RRR ET R√©ductions financi√®res.pdf" },
            { name: "TD7-La facturation ALPHA.pdf", path: "../S1/S1/Gestion de l'entreprise/TD7-La facturation ALPHA.pdf" }
        ]
    },
    {
        name: "Probabilit√©s et Simulation",
        icon: "üé≤",
        folders: [
            {
                name: "CM",
                path: "../S1/S1/Probabilit√©s et simulation/CM"
            },
            {
                name: "TD",
                path: "../S1/S1/Probabilit√©s et simulation/TD"
            }
        ],
        documents: [
            { name: "Ch1.pdf", path: "../S1/S1/Probabilit√©s et simulation/Ch1.pdf" },
            { name: "Ch2 - Suite de variables al√©atoires r√©elles convergentes .pdf", path: "../S1/S1/Probabilit√©s et simulation/Ch2 - Suite de variables al√©atoires r√©elles convergentes .pdf" },
            { name: "Examen_ProbabilitesEtSimulation_Ing1-GIA_2022-01-xx.pdf", path: "../S1/S1/Probabilit√©s et simulation/Examen_ProbabilitesEtSimulation_Ing1-GIA_2022-01-xx.pdf" },
            { name: "Examen_ProbabilitesEtSimulation_Ing1-GMA_2023-01-xx.pdf", path: "../S1/S1/Probabilit√©s et simulation/Examen_ProbabilitesEtSimulation_Ing1-GMA_2023-01-xx.pdf" },
            { name: "Standard_Normale_Distribution_Table.pdf", path: "../S1/S1/Probabilit√©s et simulation/Standard_Normale_Distribution_Table.pdf" },
            { name: "TD1.pdf", path: "../S1/S1/Probabilit√©s et simulation/TD1.pdf" }
        ]
    },
    {
        name: "Syst√®me d'Exploitation",
        icon: "üíª",
        folders: [
            {
                name: "CM",
                path: "../S1/S1/Syst√®me d'exploitation/CM"
            },
            {
                name: "Docker",
                path: "../S1/S1/Syst√®me d'exploitation/Docker"
            },
            {
                name: "Examens",
                path: "../S1/S1/Syst√®me d'exploitation/Examens"
            },
            {
                name: "Resumes",
                path: "../S1/S1/Syst√®me d'exploitation/Resumes"
            },
            {
                name: "TP",
                path: "../S1/S1/Syst√®me d'exploitation/TP"
            }
        ],
        documents: [
            { name: "Cours.docx", path: "../S1/S1/Syst√®me d'exploitation/Cours.docx" }
        ]
    },
    {
        name: "Th√©orie des Langages",
        icon: "üî§",
        folders: [
            {
                name: "CM",
                path: "../S1/S1/Th√©orie des langages/CM"
            },
            {
                name: "Examens",
                path: "../S1/S1/Th√©orie des langages/Examens"
            },
            {
                name: "Support",
                path: "../S1/S1/Th√©orie des langages/Support"
            },
            {
                name: "TD",
                path: "../S1/S1/Th√©orie des langages/TD"
            }
        ],
        documents: [
            { name: "Sch√©ma.docx", path: "../S1/S1/Th√©orie des langages/Sch√©ma.docx" }
        ]
    }
];

function getFileIcon(filename) {
    const ext = filename.split('.').pop().toLowerCase();
    const icons = {
        'pdf': 'üìÑ',
        'docx': 'üìù',
        'doc': 'üìù',
        'pptx': 'üìä',
        'ppt': 'üìä',
        'txt': 'üìÉ',
        'sql': 'üóÉÔ∏è',
        'jpg': 'üñºÔ∏è',
        'jpeg': 'üñºÔ∏è',
        'png': 'üñºÔ∏è',
        'heic': 'üñºÔ∏è',
        'mp4': 'üé•',
        'ts': 'üé•',
        'pages': 'üìù',
        'bash': '‚öôÔ∏è',
        'mwb': 'üóÑÔ∏è',
        'lo1': 'üìê',
        'loo': 'üìê'
    };
    return icons[ext] || 'üìé';
}

function canPreview(filename) {
    const ext = filename.split('.').pop().toLowerCase();
    return ['pdf', 'txt', 'jpg', 'jpeg', 'png', 'mp4'].includes(ext);
}

function renderCourses(courses = coursesData) {
    const container = document.getElementById('coursesContainer');
    
    if (courses.length === 0) {
        container.innerHTML = '<div class="no-results">Aucun r√©sultat trouv√©</div>';
        return;
    }
    
    container.innerHTML = courses.map((course, index) => {
        const totalDocs = (course.documents?.length || 0) + (course.folders?.length || 0);
        
        return `
            <div class="course-card" data-course="${course.name.toLowerCase()}">
                <div class="course-header" onclick="toggleDocuments(${index})">
                    <span class="course-icon">${course.icon}</span>
                    <div class="course-title">
                        <h2>${course.name}</h2>
                        <span class="course-count">${totalDocs} √©l√©ment${totalDocs > 1 ? 's' : ''}</span>
                    </div>
                    <button class="toggle-btn" id="toggle-${index}">+</button>
                </div>
                <div class="documents-list" id="docs-${index}">
                    ${course.folders ? course.folders.map(folder => `
                        <div class="folder">
                            <div class="folder-name">${folder.name}</div>
                            <div class="document-item">
                                <span class="document-name">
                                    <span class="file-icon">üìÅ</span>
                                    Dossier complet
                                </span>
                                <div class="document-actions">
                                    <a href="${folder.path}" class="btn btn-download" download>T√©l√©charger</a>
                                </div>
                            </div>
                        </div>
                    `).join('') : ''}
                    ${course.documents ? course.documents.map(doc => `
                        <div class="document-item" data-doc="${doc.name.toLowerCase()}">
                            <span class="document-name">
                                <span class="file-icon">${getFileIcon(doc.name)}</span>
                                ${doc.name}
                            </span>
                            <div class="document-actions">
                                ${canPreview(doc.name) ? `<a href="${doc.path}" class="btn btn-view" target="_blank">Voir</a>` : ''}
                                <a href="${doc.path}" class="btn btn-download" download>T√©l√©charger</a>
                            </div>
                        </div>
                    `).join('') : ''}
                </div>
            </div>
        `;
    }).join('');
}

function toggleDocuments(index) {
    const docsList = document.getElementById(`docs-${index}`);
    const toggleBtn = document.getElementById(`toggle-${index}`);
    
    docsList.classList.toggle('active');
    toggleBtn.textContent = docsList.classList.contains('active') ? '‚àí' : '+';
}

document.getElementById('searchInput').addEventListener('input', (e) => {
    const searchTerm = e.target.value.toLowerCase();
    
    if (!searchTerm) {
        renderCourses();
        return;
    }
    
    const filtered = coursesData.filter(course => {
        const courseName = course.name.toLowerCase().includes(searchTerm);
        const hasDoc = course.documents?.some(doc => doc.name.toLowerCase().includes(searchTerm));
        const hasFolder = course.folders?.some(folder => folder.name.toLowerCase().includes(searchTerm));
        return courseName || hasDoc || hasFolder;
    });
    
    renderCourses(filtered);
});

renderCourses();
