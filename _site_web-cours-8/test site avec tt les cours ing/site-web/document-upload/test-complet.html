<!DOCTYPE html>
<html lang="fr" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Complet - Syst√®me d'Upload</title>
    <link rel="stylesheet" href="../style.css">
    <link rel="stylesheet" href="upload-modal.css">
    <style>
        body { padding: 40px; background: var(--bg-body); }
        .test-panel { background: var(--card-bg); padding: 30px; border-radius: 15px; margin-bottom: 20px; box-shadow: var(--shadow); }
        .test-title { color: var(--primary); font-size: 1.5em; margin-bottom: 15px; }
        .test-btn { padding: 12px 24px; background: var(--primary); color: white; border: none; border-radius: 10px; cursor: pointer; margin: 5px; }
        .test-result { margin-top: 15px; padding: 15px; background: var(--bg-body); border-radius: 8px; font-family: monospace; }
    </style>
</head>
<body>
    <div class="test-panel">
        <div class="test-title">üß™ Tests du Syst√®me d'Upload</div>
        
        <h3>1. Test d'ouverture de la modale</h3>
        <button class="test-btn" onclick="testOpenModal()">Ouvrir la modale</button>
        
        <h3>2. Test de classification</h3>
        <button class="test-btn" onclick="testClassification()">Tester l'algorithme</button>
        <div id="classificationResult" class="test-result" style="display:none;"></div>
        
        <h3>3. Test des fonctionnalit√©s avanc√©es</h3>
        <button class="test-btn" onclick="testAdvancedFeatures()">Tester les fonctionnalit√©s</button>
        
        <h3>4. Test de performance</h3>
        <button class="test-btn" onclick="testPerformance()">Test de performance</button>
        <div id="performanceResult" class="test-result" style="display:none;"></div>
        
        <h3>5. V√©rification compl√®te</h3>
        <button class="test-btn" onclick="runAllTests()">Lancer tous les tests</button>
        <div id="allTestsResult" class="test-result" style="display:none;"></div>
    </div>

    <script src="content-extractor.js"></script>
    <script src="classifier.js"></script>
    <script src="upload-manager.js"></script>
    <script src="animations.js"></script>
    <script src="advanced-features.js"></script>
    
    <script>
        function testOpenModal() {
            if (typeof uploadManager !== 'undefined') {
                uploadManager.openModal();
                console.log('‚úì Modale ouverte avec succ√®s');
            } else {
                console.error('‚úó uploadManager non d√©fini');
            }
        }

        function testClassification() {
            const testFiles = [
                'examen_bdd_2023.pdf',
                'td3_probabilites.pdf',
                'correction_tp_java.pdf',
                'cours_systeme_linux.pdf',
                'projet_python_pandas.py'
            ];
            
            const classifier = new DocumentClassifier();
            const results = testFiles.map(file => {
                const result = classifier.classify(file);
                return {
                    fichier: file,
                    mati√®re: result.subject,
                    type: result.documentType,
                    confiance: result.confidence + '%'
                };
            });
            
            const resultDiv = document.getElementById('classificationResult');
            resultDiv.style.display = 'block';
            resultDiv.innerHTML = '<pre>' + JSON.stringify(results, null, 2) + '</pre>';
            console.table(results);
            console.log('‚úì Test de classification termin√©');
        }

        function testAdvancedFeatures() {
            const features = [
                'D√©tection de doublons',
                'Actions group√©es',
                'Pr√©visualisation',
                'Navigation clavier',
                'Statistiques temps r√©el'
            ];
            
            console.log('‚úì Fonctionnalit√©s avanc√©es disponibles:');
            features.forEach(f => console.log('  - ' + f));
        }

        function testPerformance() {
            const start = performance.now();
            const classifier = new DocumentClassifier();
            
            // Test de 100 classifications
            for (let i = 0; i < 100; i++) {
                classifier.classify('test_file_' + i + '.pdf');
            }
            
            const duration = (performance.now() - start).toFixed(2);
            const resultDiv = document.getElementById('performanceResult');
            resultDiv.style.display = 'block';
            resultDiv.textContent = `100 classifications en ${duration}ms (${(duration/100).toFixed(2)}ms par fichier)`;
            console.log(`‚úì Performance: ${duration}ms pour 100 classifications`);
        }

        function runAllTests() {
            const resultDiv = document.getElementById('allTestsResult');
            resultDiv.style.display = 'block';
            
            const tests = [];
            
            // Test 1: V√©rification des objets
            tests.push({
                test: 'Objets d√©finis',
                result: typeof uploadManager !== 'undefined' && 
                        typeof advancedFeatures !== 'undefined' &&
                        typeof DocumentClassifier !== 'undefined'
            });
            
            // Test 2: Classifier
            const classifier = new DocumentClassifier();
            tests.push({
                test: 'Classifier fonctionnel',
                result: classifier.classify('test.pdf').hasOwnProperty('subject')
            });
            
            // Test 3: Mati√®res
            const subjects = classifier.getAllSubjects();
            tests.push({
                test: 'Mati√®res charg√©es',
                result: subjects.length === 19
            });
            
            // Test 4: Types de documents
            tests.push({
                test: 'Types de documents',
                result: Object.keys(classifier.documentTypes).length === 8
            });
            
            // Test 5: Content Extractor
            tests.push({
                test: 'Content Extractor',
                result: typeof ContentExtractor !== 'undefined'
            });
            
            const passed = tests.filter(t => t.result).length;
            const total = tests.length;
            
            resultDiv.innerHTML = `
                <strong>R√©sultats: ${passed}/${total} tests r√©ussis</strong><br><br>
                ${tests.map(t => `${t.result ? '‚úì' : '‚úó'} ${t.test}`).join('<br>')}
            `;
            
            console.log(`\n=== Tests complets ===`);
            console.log(`${passed}/${total} tests r√©ussis`);
            console.table(tests);
        }

        // Auto-test au chargement
        window.addEventListener('load', () => {
            setTimeout(() => {
                console.log('%cüß™ Syst√®me de test charg√©', 'color: #667eea; font-size: 16px; font-weight: bold;');
                console.log('Utilisez les boutons pour tester les fonctionnalit√©s');
            }, 1000);
        });
    </script>
</body>
</html>
